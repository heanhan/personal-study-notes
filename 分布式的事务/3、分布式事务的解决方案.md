### 3、分布式事务的解决方案

#### 3.1 2PC（两阶段提交）

**概念**：2pc 两阶段提交协议，将整个事务分为两个阶段，准备阶段和提交阶段。

**准备阶段：**

事务管理器给每个参与事务的参与者发送prepare消息，每个数据库参与者，在本地执行事务，并写入本地 undo/redo日志中，此时事务没有提交。

【补充：undo.log 日志记录修改前的数据，用于数据回滚；redo.log 是修改后的数据，可用于提交事务后写入数据文件】

**提交阶段：**

如果事务管理器收到了参数与者执行失败或者超时的消息，直接给每个参与者发送回滚消息，否则发送提交消息。参与者根据事务管理器的指令执行。

