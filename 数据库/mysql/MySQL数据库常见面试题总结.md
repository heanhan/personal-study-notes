### MySQL数据库常见面试题总结

#### 1、数据库的常用范式

```
第一范式：指表的列不可再分，数据库表中的每一列都是不可以分割的基本数据项，同一列中不可能有多个值。
第二范式：在第一范式的基础上，还包含两部分的内容，一个表必须有一个主键，二是表中非主键列必须完全依赖于主键。不能只依赖于主键的一部分。
第三范式：在第二范式的基础上，消除非主键列对主键的传递依赖，非主键列必须直接依赖于主键。
BC范式：
```

#### 2、SQL语句的执行过程：

2.1、客户端的数据库驱动与数据库连接池：
（1）客户端与数据库进行通信前，通过数据库驱动与MySQL建立连接，建立完成之后，就发送SQL语句

（2）为了减少频繁创建和销毁连接造成系统性能的下降，通过数据库连接池维护一定数量的连接线程，当需要进行连接时，就直接从连接池中获取，使用完毕之后，再归还给连接池。常见的数据库连接池有 Druid、C3P0、DBCP

#### 2.2、MySQL架构的Server层的执行过程：

（1）连接器：主要负责跟客户端建立连接、获取权限、维持和管理连接

（2）查询缓存：优先在缓存中进行查询，如果查到了则直接返回，如果缓存中查询不到，在去数据库中查询。

MySQL缓存是默认关闭的，也就是说不推荐使用缓存，并且在MySQL8.0 版本已经将查询缓存的整块功能删掉了。这主要是它的使用场景限制造成的：

        先说下缓存中数据存储格式：key（sql语句）- value（数据值），所以如果SQL语句（key）只要存在一点不同之处就会直接进行数据库查询了；


        由于表中的数据不是一成不变的，大多数是经常变化的，而当数据库中的数据变化了，那么相应的与此表相关的缓存数据就需要移除掉；


（3）解析器/分析器：分析器的工作主要是对要执行的SQL语句进行词法解析、语法解析，最终得到抽象语法树，然后再使用预处理器对抽象语法树进行语义校验，判断抽象语法树中的表是否存在，如果存在的话，在接着判断select投影列字段是否在表中存在等。

（4）优化器：主要将SQL经过词法解析、语法解析后得到的语法树，通过数据字典和统计信息的内容，再经过一系列运算 ，最终得出一个执行计划，包括选择使用哪个索引

在分析是否走索引查询时，是通过进行动态数据采样统计分析出来；只要是统计分析出来的，那就可能会存在分析错误的情况，所以在SQL执行不走索引时，也要考虑到这方面的因素

（5）执行器：根据一系列的执行计划去调用存储引擎提供的API接口去调用操作数据，完成SQL的执行。

#### 2.3 Innodb存储引擎的执行过程

1. 首先Mysql执行器根据执行计划调用存储引擎的api查询数据。
2. 存储引擎先从缓存池中 buffer pool中查询数据，如果没有就会去磁盘中查询，如果查询到了机会将其放到缓存池中。
3. 在数据加载到buffer pool的同时会将这条数据的原始记录保存到 undo 日志文件中
4. innodb 会在 Buffer Pool 中执行更新操作