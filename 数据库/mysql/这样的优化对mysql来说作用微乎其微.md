### 大局观上总结mysql的优化思路

关于mysql的数据库来说，我们最常遇到的即使关于栖优化问题，通常我们在回答mysql数据库优化的相关问题时一般会从三个层面来说明：

- 硬件层面
- 存储引擎层面
- sql 语句层面

今天我们在这里不展开说明这些问题，而是跟大家杰捎着洗优化层面中，有哪些优化对mysql数据哭来说的是微乎其微的。

#### 一、硬件层面

首先，我们介绍一下关于MYSQL 数据库硬件层面的优化。

要说硬件层面的优化，无外乎是CPU、网络、磁盘和内存四个方面。

其中，CPU处理数据的能力的强弱直接影响着MYSQL数据库吃力数据的时间，也就是说CPU处理数据能力越强，mysql数据库在处理数据室的速度就越快。

网卡的转发能力的强弱影响着网络延时的长短。举个例子，去年公司开年会的时候，一个必要的环节就是老板发红包，我用的是iphone 13. 我旁边的一个同事用的是华为，基本上我没有抢到什么红包，但是华为手机却抢到很多，这个原因其实大家都知道，是华为手机的信号基带延时非常低，这个例子说明在同等条件下，网卡的网络转发能力越强，mysql数据库接收处理的信号的速度就越快。

上面两个方面的优化一般可以说性能越好效果就越好，但是磁盘和内存条的性能越好，效果不一定好。

我们就介绍一下磁盘。

我们通常接触到的一个说法就是固态硬盘的性能要比机械硬盘的性能要好。那么我们现在有一台mysql数据库的服务器，他的底层存储是机械硬盘，我们现在需要优化这台mysql数据库，按照前面的说法，我们得知只要将机械硬盘换成固态硬盘即可。

但是事实是这样吗？不一定。

这是因为，mysql数据并不是直接通过磁盘去了解磁盘IO能力的，而是通过其自身的一个叫innodb_io_capacity的参数来控制的。

假设你是按照机械硬盘的IO能力来设置innodb_io_capacity的，那么此时哪怕你讲机械硬盘换成固态硬盘，mysql数据库仍然认为底层使用的是机械硬盘，以至于更换固态硬盘之后的mysql的数据性能的提升微乎其微。

内存也是一样。

我们在了解InnoDB存储引擎的地城原理时，我们可以清楚的了解到，要想使mysql的数据库处理数据的能力有所提升，那么单纯的提升mysql部署服务器的内存空间是不行的，而是需要在提升服务器的内存空间大小是，同事修改InnoDB存储引擎的buffer pool的内存空间大小，这样才能有效的提升mysql的数据库的性能。

#### 二、存储引擎层面

#### 三、SQL语句层面

SQL层面，是我们优化MYSQL数据库最直接的一个层面，在这个层面，有很多需要我们注意的地方，下面我们就来了解一下这个话题。

> 注意：再详细说明SQL层面相关问题之前，我们需要先了解sql的运行周期。

##### 1、索引是不是越多越好

要想搞清楚索引是不是越多越好，首先我们需要搞清楚索引是什么

mysql官方给的解释：Mysql 数据库中的索引是一种用作一列或者多列值之间排序的数据结构。

索引一般常用的排序的字段我们是需要加上索引的，不常用的字段通常情况下不建议添加索引。

而且，索引我们可以形象的将其理解为MYSQL数据库中的一种特殊的虚拟表，这个虚拟数据表中的字段只有当前这个索引包含的字段，然后存储在  .bd文件中；也就是说，当我们建立的索引越多，mysql数据库维护的索引文件就越多，那么如果某一个数据库表中的数据比较少时，简历过多的索引对于mysql数据库来说其实是一种负担。

##### 2、是不是每次连接数据库就一定能够成功

一条sql执行之前客户端和服务端之间需要简历TCP连接的。

要知道，要建立TCP连接除了需要三次我收并且还需要权限验证以及安全认证。在这个认证和建立连接的过程中非常消耗时间。

那么，如果在某一个很短的时间内，建立了很多mysql数据库的连接，此时的mysql数据库有可能会不堪重负进而导致宕机。

为了解决这个问题，mysql数据库提供了一个max_connections参数，这个参数的主要作用是限制同一时间创建mysql数据库的连接上限，如同在同一个时间创建的连接数超过了改参数设置的值之后，mysql数据库会返回一个ERROR 1040(HY000) : Too many connections.的错误，